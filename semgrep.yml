rules:
  - id: no-eval
    languages:
      - javascript
    pattern: |
      eval($X)
    message: "Avoid using eval to prevent security issues."
    severity: ERROR

  - id: no-command-injection
    languages:
      - javascript
    pattern: |
      exec($X, ...)
    message: "Avoid using exec with user input to prevent command injection vulnerabilities."
    severity: ERROR

  - id: xss-vulnerability
    languages:
      - javascript
    pattern: |
      innerHTML = $X
    message: "Avoid using innerHTML with user input to prevent XSS vulnerabilities."
    severity: ERROR

  - id: js-eval-detected
    patterns:
      - pattern: eval($INPUT)
    message: "The use of eval() is dangerous and can lead to code injection vulnerabilities."
    severity: ERROR
    languages:
      - javascript
    metadata:
      category: security
      technology:
        - javascript
    references:
      - https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval
    fix: "Avoid using eval() or ensure the input is sanitized properly."
 
  - id: hard-coded-secret
    patterns:
      - pattern: '$SECRET = ...'
    message: 'Hard-coded secret detected. Consider using environment variables or secure storage.'
    languages: [javascript]
    severity: ERROR

  - id: sql-injection
    patterns:
      - pattern: |
          $SQL_QUERY = `SELECT * FROM users WHERE name = '$USER_INPUT'`
    message: 'Possible SQL injection vulnerability detected.'
    languages: [javascript]
    severity: ERROR

  - id: xss
    patterns:
      - pattern: |
          res.send(`<div>$USER_INPUT</div>`)
    message: 'Possible XSS vulnerability detected.'
    languages: [javascript]
    severity: ERROR

  - id: command-injection
    patterns:
      - pattern: |
          exec(`ls $USER_INPUT`, ...)
    message: 'Possible command injection vulnerability detected.'
    languages: [javascript]
    severity: ERROR 

  - id: javascript-command-injection
    patterns:
      - pattern: exec($CMD, $CALLBACK)
      - pattern: spawn($CMD, ...)
    message: |
      Detected potential command injection vulnerability.
      User input is passed directly to system commands.
      Ensure that user input is properly sanitized or validated before use.
    languages: [javascript]
    severity: ERROR
  
